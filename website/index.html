<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>2026 Midterm Elections Forecast | Grant Williams</title>
    <meta name="description" content="Bayesian hierarchical forecasting model for the 2026 U.S. House and Senate elections. Updated daily with polling and economic data.">

    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">

    <!-- Leaflet CSS -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />

    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

    <!-- Leaflet JS -->
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>

    <!-- Styles -->
    <link rel="stylesheet" href="css/style.css">
</head>
<body>
    <!-- Header -->
    <header class="header">
        <div class="container">
            <div class="header-content">
                <a href="/" class="logo">Grant Williams</a>
                <nav class="nav">
                    <a href="#house">House</a>
                    <a href="#senate">Senate</a>
                    <a href="#map">Map</a>
                    <a href="#districts">Districts</a>
                    <a href="#methodology">Methodology</a>
                </nav>
            </div>
        </div>
    </header>

    <!-- Chamber Toggle -->
    <section class="chamber-toggle-section">
        <div class="container">
            <div class="chamber-toggle">
                <button class="chamber-btn active" data-chamber="house">House</button>
                <button class="chamber-btn" data-chamber="senate">Senate</button>
            </div>
        </div>
    </section>

    <!-- House Hero Section -->
    <section id="house" class="hero chamber-section active" data-chamber="house">
        <div class="container">
            <div class="hero-header">
                <h1>2026 House Forecast</h1>
                <p class="update-time">Updated: <span id="update-time">Loading...</span></p>
            </div>

            <!-- Top-line Cards -->
            <div class="stats-grid">
                <div class="stat-card primary dem">
                    <div class="stat-value" id="house-dem-prob">--</div>
                    <div class="stat-label">Democratic Majority</div>
                    <div class="stat-sublabel">Probability</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="house-median-seats">--</div>
                    <div class="stat-label">Median Dem Seats</div>
                    <div class="stat-sublabel">218 needed for majority</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="house-confidence-interval">--</div>
                    <div class="stat-label">90% Confidence</div>
                    <div class="stat-sublabel">Interval</div>
                </div>
            </div>

            <!-- Seat Categories Bar -->
            <div class="categories-section">
                <h3>Seat Breakdown</h3>
                <div class="categories-bar" id="house-categories-bar"></div>
                <div class="categories-legend">
                    <span class="legend-item safe-d">Safe D</span>
                    <span class="legend-item likely-d">Likely D</span>
                    <span class="legend-item lean-d">Lean D</span>
                    <span class="legend-item tossup">Toss-up</span>
                    <span class="legend-item lean-r">Lean R</span>
                    <span class="legend-item likely-r">Likely R</span>
                    <span class="legend-item safe-r">Safe R</span>
                </div>
            </div>

            <!-- National Environment -->
            <div class="environment-section">
                <h3>Political Environment</h3>
                <div class="environment-grid">
                    <div class="env-item">
                        <span class="env-value" id="national-env">--</span>
                        <span class="env-label">National Swing</span>
                    </div>
                    <div class="env-item">
                        <span class="env-value" id="generic-ballot">--</span>
                        <span class="env-label">Generic Ballot</span>
                    </div>
                    <div class="env-item">
                        <span class="env-value" id="approval">--</span>
                        <span class="env-label">Trump Approval</span>
                    </div>
                    <div class="env-item">
                        <span class="env-value" id="days-until">--</span>
                        <span class="env-label">Days to Election</span>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Senate Hero Section -->
    <section id="senate" class="hero chamber-section" data-chamber="senate">
        <div class="container">
            <div class="hero-header">
                <h1>2026 Senate Forecast</h1>
                <p class="update-time">Updated: <span id="senate-update-time">Loading...</span></p>
            </div>

            <!-- Top-line Cards -->
            <div class="stats-grid">
                <div class="stat-card primary dem">
                    <div class="stat-value" id="senate-dem-prob">--</div>
                    <div class="stat-label">Democratic Control</div>
                    <div class="stat-sublabel">Probability (50 seats + VP)</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="senate-median-seats">--</div>
                    <div class="stat-label">Median Dem Seats</div>
                    <div class="stat-sublabel">50 needed for control</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="senate-confidence-interval">--</div>
                    <div class="stat-label">90% Confidence</div>
                    <div class="stat-sublabel">Interval</div>
                </div>
            </div>

            <!-- Senate Categories -->
            <div class="categories-section">
                <h3>Race Ratings (<span id="senate-seats-up">33</span> seats up)</h3>
                <div class="categories-bar" id="senate-categories-bar"></div>
                <div class="categories-legend">
                    <span class="legend-item safe-d">Safe D</span>
                    <span class="legend-item likely-d">Likely D</span>
                    <span class="legend-item lean-d">Lean D</span>
                    <span class="legend-item tossup">Toss-up</span>
                    <span class="legend-item lean-r">Lean R</span>
                    <span class="legend-item likely-r">Likely R</span>
                    <span class="legend-item safe-r">Safe R</span>
                </div>
            </div>

            <!-- Defending Seats -->
            <div class="environment-section">
                <h3>Seats Up for Election</h3>
                <div class="environment-grid" style="grid-template-columns: repeat(2, 1fr);">
                    <div class="env-item">
                        <span class="env-value dem-text" id="senate-dem-defending">--</span>
                        <span class="env-label">Democrats Defending</span>
                    </div>
                    <div class="env-item">
                        <span class="env-value rep-text" id="senate-rep-defending">--</span>
                        <span class="env-label">Republicans Defending</span>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Interactive Map -->
    <section id="map" class="section">
        <div class="container">
            <h2 id="map-title">Congressional District Map</h2>
            <p class="section-desc" id="map-desc">Click any district for detailed forecast. Color indicates race rating.</p>
            <div id="map-container"></div>
            <div class="map-legend">
                <span class="legend-item safe-d">Safe D</span>
                <span class="legend-item likely-d">Likely D</span>
                <span class="legend-item lean-d">Lean D</span>
                <span class="legend-item tossup">Toss-up</span>
                <span class="legend-item lean-r">Lean R</span>
                <span class="legend-item likely-r">Likely R</span>
                <span class="legend-item safe-r">Safe R</span>
            </div>
        </div>
    </section>

    <!-- Seat Distribution Chart -->
    <section id="distribution" class="section bg-alt">
        <div class="container">
            <h2>Seat Distribution</h2>
            <p class="section-desc">Distribution of seats across 10,000 simulated elections</p>
            <div class="chart-container">
                <canvas id="seat-chart"></canvas>
            </div>
            <div class="chart-stats" id="chart-stats"></div>
        </div>
    </section>

    <!-- District/Race Table -->
    <section id="districts" class="section">
        <div class="container">
            <h2 id="table-title">All 435 Districts</h2>

            <!-- Filters -->
            <div class="filters">
                <div class="filter-group">
                    <label for="state-filter">State</label>
                    <select id="state-filter">
                        <option value="">All States</option>
                    </select>
                </div>
                <div class="filter-group">
                    <label for="category-filter">Rating</label>
                    <select id="category-filter">
                        <option value="">All Ratings</option>
                        <option value="safe_d">Safe D</option>
                        <option value="likely_d">Likely D</option>
                        <option value="lean_d">Lean D</option>
                        <option value="toss_up">Toss-up</option>
                        <option value="lean_r">Lean R</option>
                        <option value="likely_r">Likely R</option>
                        <option value="safe_r">Safe R</option>
                    </select>
                </div>
                <div class="filter-group">
                    <label for="search-filter">Search</label>
                    <input type="text" id="search-filter" placeholder="District or incumbent...">
                </div>
            </div>

            <!-- Table -->
            <div class="table-wrapper">
                <table class="district-table" id="district-table">
                    <thead>
                        <tr>
                            <th data-sort="id">District</th>
                            <th data-sort="incumbent">Incumbent</th>
                            <th data-sort="pvi">PVI</th>
                            <th data-sort="prob_dem">Dem %</th>
                            <th data-sort="category">Rating</th>
                        </tr>
                    </thead>
                    <tbody id="district-tbody"></tbody>
                </table>
            </div>

            <div class="table-info">
                Showing <span id="showing-count">0</span> of <span id="total-count">435</span> races
            </div>
        </div>
    </section>

    <!-- Methodology -->
    <section id="methodology" class="section bg-alt">
        <div class="container">
            <h2>Methodology</h2>

            <div class="methodology-content">
                <div class="method-section">
                    <h3>Model Overview</h3>
                    <p>This is a <strong>Bayesian hierarchical forecasting model</strong> that produces probabilistic predictions for all 435 House races and 33 Senate races. The model has three layers:</p>
                    <ol>
                        <li><strong>National Layer:</strong> Combines fundamentals (approval ratings, economic conditions, midterm dynamics) with polling (generic ballot) to estimate the overall political environment.</li>
                        <li><strong>Regional Layer:</strong> Captures how different regions respond to the national environment.</li>
                        <li><strong>District/State Layer:</strong> Predicts vote share using partisan lean (PVI) and incumbency advantage.</li>
                    </ol>
                </div>

                <div class="method-section">
                    <h3>Uncertainty Quantification</h3>
                    <p>The model runs <strong>10,000 Monte Carlo simulations</strong> to generate probability distributions. This captures:</p>
                    <ul>
                        <li>Uncertainty in the national environment</li>
                        <li>Regional variation</li>
                        <li>State/district-level polling error</li>
                        <li>Correlated errors (races don't move independently)</li>
                    </ul>
                </div>

                <div class="method-section">
                    <h3>Data Sources</h3>
                    <ul>
                        <li><strong>Polling:</strong> Generic ballot and presidential approval polls</li>
                        <li><strong>Economic:</strong> FRED API (unemployment, GDP, disposable income)</li>
                        <li><strong>Fundamentals:</strong> District/state PVI from 2024 presidential results</li>
                        <li><strong>Map Data:</strong> <a href="https://www.census.gov/geographies/mapping-files/time-series/geo/carto-boundary-file.html" target="_blank">U.S. Census Bureau TIGER/Line</a></li>
                    </ul>
                </div>

                <div class="method-section">
                    <h3>Key Parameters</h3>
                    <table class="params-table">
                        <tr><td>Incumbency Advantage (House)</td><td>~3 points</td></tr>
                        <tr><td>Incumbency Advantage (Senate)</td><td>~4 points</td></tr>
                        <tr><td>Midterm Penalty</td><td>~3.5 points against president's party</td></tr>
                        <tr><td>District Uncertainty</td><td>~4.5 point standard deviation</td></tr>
                    </table>
                </div>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer class="footer">
        <div class="container">
            <p>&copy; 2026 Grant Williams. Model updates daily.</p>
            <p class="footer-links">
                <a href="https://github.com" target="_blank">GitHub</a>
                <a href="mailto:grant@example.com">Contact</a>
            </p>
        </div>
    </footer>

    <!-- District Modal -->
    <div class="modal" id="district-modal">
        <div class="modal-content">
            <button class="modal-close" id="modal-close">&times;</button>
            <div id="modal-body"></div>
        </div>
    </div>

    <script src="js/app.js"></script>
</body>
</html>
